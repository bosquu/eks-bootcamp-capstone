"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ClusterInfo = exports.GlobalResources = exports.ResourceContext = void 0;
const assert = require("assert");
/**
 * Provides API to register resource providers and get access to the provided resources.
 */
class ResourceContext {
    constructor(scope, blueprintProps) {
        this.scope = scope;
        this.blueprintProps = blueprintProps;
        this.resources = new Map();
    }
    /**
     * Adds a new resource provider and specifies the name under which the provided resource will be registered,
     * @param name Specifies the name key under which the provided resources will be registered for subsequent look-ups.
     * @param provider Implementation of the resource provider interface
     * @returns the provided resource
     */
    add(name, provider) {
        const resource = provider.provide(this);
        assert(!this.resources.has(name), `Overwriting ${name} resource during execution is not allowed.`);
        this.resources.set(name, resource);
        return resource;
    }
    /**
     * Gets the provided resource by the supplied name.
     * @param name under which the resource provider was registered
     * @returns the resource or undefined if the specified resource was not found
     */
    get(name) {
        return this.resources.get(name);
    }
}
exports.ResourceContext = ResourceContext;
var GlobalResources;
(function (GlobalResources) {
    GlobalResources["Vpc"] = "vpc";
    GlobalResources["HostedZone"] = "hosted-zone";
    GlobalResources["Certificate"] = "certificate";
})(GlobalResources = exports.GlobalResources || (exports.GlobalResources = {}));
/**
 * Cluster info supplies required information on the cluster configuration, registered resources and add-ons
 * which could be leveraged by the framework, add-on implementations and teams.
 */
class ClusterInfo {
    /**
     * Constructor for ClusterInfo
     * @param props
     */
    constructor(cluster, version, nodeGroups, autoscalingGroups) {
        this.cluster = cluster;
        this.version = version;
        this.nodeGroups = nodeGroups;
        this.autoscalingGroups = autoscalingGroups;
        this.cluster = cluster;
        this.provisionedAddOns = new Map();
        this.scheduledAddOns = new Map();
    }
    /**
     * Provides the resource context object associated with this instance of the EKS Blueprint.
     * @returns resource context object
     */
    getResourceContext() {
        return this.resourceContext;
    }
    /**
     * Injection method to provide resource context.
     * @param resourceContext
     */
    setResourceContext(resourceContext) {
        this.resourceContext = resourceContext;
    }
    /**
     * Update provisionedAddOns map
     * @param addOn
     * @param construct
     */
    addProvisionedAddOn(addOn, construct) {
        this.provisionedAddOns.set(addOn, construct);
    }
    /**
     * Given the addOn name, return the provisioned addOn construct
     * @param addOn
     * @returns undefined
     */
    getProvisionedAddOn(addOn) {
        return this.provisionedAddOns.get(addOn);
    }
    /**
    * Returns all provisioned addons
    * @returns scheduledAddOns: Map<string, cdk.Construct>
    */
    getAllProvisionedAddons() {
        return this.provisionedAddOns;
    }
    /**
     * Set the preProvisionedAddOn map with the promise for the construct
     * of the addon being provisioned
     * @param addOn
     * @param promise
     */
    addScheduledAddOn(addOn, promise) {
        this.scheduledAddOns.set(addOn, promise);
    }
    /**
     * Returns the promise for the Addon construct
     * @param addOn
     * @returns Promise<cdk.Construct>
     */
    getScheduledAddOn(addOn) {
        return this.scheduledAddOns.get(addOn);
    }
    /**
     * Returns all scheduled addons
     * @returns scheduledAddOns: Map<string, Promise<cdk.Construct>>
     */
    getAllScheduledAddons() {
        return this.scheduledAddOns;
    }
    /**
     * Provides the resource registered under supplied name
     * @param name of the resource to be returned
     * @returns Resource object or undefined if no resource was found
     */
    getResource(name) {
        return this.resourceContext.get(name);
    }
    /**
     * Same as {@link getResource} but will fail if the specified resource is not found
     * @param name of the resource to be returned
     * @returns Resource object (fails if not found)
     */
    getRequiredResource(name) {
        const result = this.resourceContext.get(name);
        assert(result, 'Required resource ' + name + ' is missing.');
        return result;
    }
}
exports.ClusterInfo = ClusterInfo;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9saWIvc3BpL3R5cGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLGlDQUFpQztBQTJFakM7O0dBRUc7QUFDSCxNQUFhLGVBQWU7SUFJeEIsWUFBNEIsS0FBZ0IsRUFBa0IsY0FBaUM7UUFBbkUsVUFBSyxHQUFMLEtBQUssQ0FBVztRQUFrQixtQkFBYyxHQUFkLGNBQWMsQ0FBbUI7UUFGOUUsY0FBUyxHQUErQixJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRStCLENBQUM7SUFFbkc7Ozs7O09BS0c7SUFDSSxHQUFHLENBQTBDLElBQVksRUFBRSxRQUE2QjtRQUMzRixNQUFNLFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLGVBQWUsSUFBSSw0Q0FBNEMsQ0FBQyxDQUFDO1FBQ25HLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNuQyxPQUFPLFFBQVEsQ0FBQztJQUNwQixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEdBQUcsQ0FBMEMsSUFBWTtRQUM1RCxPQUFVLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7Q0FDSjtBQTNCRCwwQ0EyQkM7QUFFRCxJQUFZLGVBSVg7QUFKRCxXQUFZLGVBQWU7SUFDdkIsOEJBQVcsQ0FBQTtJQUNYLDZDQUEwQixDQUFBO0lBQzFCLDhDQUEyQixDQUFBO0FBQy9CLENBQUMsRUFKVyxlQUFlLEdBQWYsdUJBQWUsS0FBZix1QkFBZSxRQUkxQjtBQUdEOzs7R0FHRztBQUNILE1BQWEsV0FBVztJQU1wQjs7O09BR0c7SUFDSCxZQUFxQixPQUFnQixFQUFXLE9BQTBCLEVBQ3pELFVBQXdCLEVBQVcsaUJBQXNDO1FBRHJFLFlBQU8sR0FBUCxPQUFPLENBQVM7UUFBVyxZQUFPLEdBQVAsT0FBTyxDQUFtQjtRQUN6RCxlQUFVLEdBQVYsVUFBVSxDQUFjO1FBQVcsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFxQjtRQUN0RixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN2QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxHQUFHLEVBQXFCLENBQUM7UUFDdEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLEdBQUcsRUFBOEIsQ0FBQztJQUNqRSxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksa0JBQWtCO1FBQ3JCLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUNoQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksa0JBQWtCLENBQUMsZUFBZ0M7UUFDdEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7SUFDM0MsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxtQkFBbUIsQ0FBQyxLQUFhLEVBQUUsU0FBb0I7UUFDMUQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxtQkFBbUIsQ0FBQyxLQUFhO1FBQ3BDLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUE7OztNQUdFO0lBQ00sdUJBQXVCO1FBQzVCLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDO0lBQ2xDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLGlCQUFpQixDQUFDLEtBQWEsRUFBRSxPQUEyQjtRQUNoRSxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxpQkFBaUIsQ0FBQyxLQUFhO1FBQ2xDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUVEOzs7T0FHRztJQUNJLHFCQUFxQjtRQUN4QixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUM7SUFDaEMsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxXQUFXLENBQTBCLElBQVk7UUFDcEQsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBSSxJQUFJLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLG1CQUFtQixDQUEwQixJQUFZO1FBQzVELE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFJLElBQUksQ0FBQyxDQUFDO1FBQ2pELE1BQU0sQ0FBQyxNQUFNLEVBQUUsb0JBQW9CLEdBQUcsSUFBSSxHQUFHLGNBQWMsQ0FBQyxDQUFDO1FBQzdELE9BQU8sTUFBTyxDQUFDO0lBQ25CLENBQUM7Q0FDSjtBQXpHRCxrQ0F5R0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBhc3NlcnQgZnJvbSBcImFzc2VydFwiO1xuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7IEF1dG9TY2FsaW5nR3JvdXAgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYXV0b3NjYWxpbmcnO1xuaW1wb3J0IHsgQ2x1c3RlciwgS3ViZXJuZXRlc1ZlcnNpb24sIE5vZGVncm91cCB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1la3MnO1xuaW1wb3J0IHsgQ29uc3RydWN0IH0gZnJvbSAnY29uc3RydWN0cyc7XG5pbXBvcnQgeyBSZXNvdXJjZVByb3ZpZGVyIH0gZnJvbSAnLic7XG5pbXBvcnQgeyBFa3NCbHVlcHJpbnRQcm9wcyB9IGZyb20gJy4uL3N0YWNrcyc7XG5cbi8qKlxuICogRGF0YSB0eXBlIGRlZmluaW5nIGhlbG0gcmVwb3NpdG9yaWVzIGZvciBHaXRPcHMgYm9vdHN0cmFwcGluZy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBIZWxtUmVwb3NpdG9yeSB7XG4gICAgcmVwb1VybDogc3RyaW5nLFxuICAgIG5hbWU6IHN0cmluZyxcbiAgICB1c2VybmFtZT86IHN0cmluZyxcbiAgICBwYXNzd29yZD86IHN0cmluZ1xufVxuXG4vKipcbiAqIFV0aWxpdHkgdHlwZSBmb3IgdmFsdWVzIHBhc3NlZCB0byBIZWxtIG9yIEdpdE9wcyBhcHBsaWNhdGlvbnMuXG4gKi9cbiBleHBvcnQgdHlwZSBWYWx1ZXMgPSB7XG4gICAgW2tleTogc3RyaW5nXTogYW55O1xufTtcblxuLyoqXG4gKiBJbnRlcmZhY2UgdGhhdCBpbmNsdWRlcyBhIHJlZmVyZW5jZSB0byBhIEdpdCByZXBvc2l0b3J5IGZvciByZXVzZSwgd2l0aG91dCBjcmVkZW50aWFscyBcbiAqIGFuZCBvdGhlciBhY2Nlc3MgaW5mb3JtYXRpb24uXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgR2l0UmVwb3NpdG9yeVJlZmVyZW5jZSB7XG4gICAgLyoqXG4gICAgICogRXhwZWN0ZWQgdG8gc3VwcG9ydCBoZWxtIHN0eWxlIHJlcG8gYXQgdGhlIG1vbWVudFxuICAgICAqL1xuICAgIHJlcG9Vcmw6IHN0cmluZyxcblxuICAgIC8qKiBcbiAgICAgKiBQYXRoIHdpdGhpbiB0aGUgcmVwb3NpdG9yeSBcbiAgICAgKi9cbiAgICBwYXRoPzogc3RyaW5nLFxuXG4gICAgLyoqXG4gICAgICogT3B0aW9uYWwgbmFtZSBmb3IgdGhlIGJvb3RzdHJhcCBhcHBsaWNhdGlvblxuICAgICAqL1xuICAgIG5hbWU/OiBzdHJpbmcsXG5cbiAgICAvKipcbiAgICAgKiBPcHRpb25hbCB0YXJnZXQgcmV2aXNpb24gZm9yIHRoZSByZXBvc2l0b3J5LlxuICAgICAqIFRhcmdldFJldmlzaW9uIGRlZmluZXMgdGhlIHJldmlzaW9uIG9mIHRoZSBzb3VyY2VcbiAgICAgKiB0byBzeW5jIHRoZSBhcHBsaWNhdGlvbiB0by4gSW4gY2FzZSBvZiBHaXQsIHRoaXMgY2FuIGJlXG4gICAgICogY29tbWl0LCB0YWcsIG9yIGJyYW5jaC4gSWYgb21pdHRlZCwgd2lsbCBlcXVhbCB0byBIRUFELlxuICAgICAqIEluIGNhc2Ugb2YgSGVsbSwgdGhpcyBpcyBhIHNlbXZlciB0YWcgZm9yIHRoZSBDaGFydCdzIHZlcnNpb24uXG4gICAgICovXG4gICAgdGFyZ2V0UmV2aXNpb24/OiBzdHJpbmdcbn1cblxuLyoqXG4gKiBEYXRhIHR5cGUgZGVmaW5pbmcgYW4gYXBwbGljYXRpb24gcmVwb3NpdG9yeSAoZ2l0KS4gXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgQXBwbGljYXRpb25SZXBvc2l0b3J5IGV4dGVuZHMgR2l0UmVwb3NpdG9yeVJlZmVyZW5jZSB7XG5cbiAgICAvKipcbiAgICAgKiBTZWNyZXQgZnJvbSBBV1MgU2VjcmV0cyBNYW5hZ2VyIHRvIGltcG9ydCBjcmVkZW50aWFscyB0byBhY2Nlc3MgdGhlIHNwZWNpZmllZCBnaXQgcmVwb3NpdG9yeS5cbiAgICAgKiBUaGUgc2VjcmV0IG11c3QgZXhpc3QgaW4gdGhlIHNhbWUgcmVnaW9uIGFuZCBhY2NvdW50IHdoZXJlIHRoZSBzdGFjayB3aWxsIHJ1bi4gXG4gICAgICovXG4gICAgY3JlZGVudGlhbHNTZWNyZXROYW1lPzogc3RyaW5nLFxuXG4gICAgLyoqXG4gICAgICogRGVwZW5kaW5nIG9uIGNyZWRlbnRpYWxzIHR5cGUgdGhlIGFybiBzaG91bGQgZWl0aGVyIHBvaW50IHRvIGFuIFNTSCBrZXkgKHBsYWluIHRleHQgdmFsdWUpXG4gICAgICogb3IgYSBqc29uIGZpbGUgd2l0aCB1c2VybmFtZS9wYXNzd29yZCBhdHRyaWJ1dGVzLlxuICAgICAqIEZvciBUT0tFTiB0eXBlIHVzZXJuYW1lIGNhbiBiZSBhbnkgbm9uLWVtcHR5IHVzZXJuYW1lIGFuZCB0b2tlbiB2YWx1ZSBhcyBwYXNzd29yZC5cbiAgICAgKi9cbiAgICBjcmVkZW50aWFsc1R5cGU/OiBcIlVTRVJOQU1FXCIgfCBcIlRPS0VOXCIgfCBcIlNTSFwiXG5cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBBUEkgdG8gcmVnaXN0ZXIgcmVzb3VyY2UgcHJvdmlkZXJzIGFuZCBnZXQgYWNjZXNzIHRvIHRoZSBwcm92aWRlZCByZXNvdXJjZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBSZXNvdXJjZUNvbnRleHQge1xuXG4gICAgcHJpdmF0ZSByZWFkb25seSByZXNvdXJjZXM6IE1hcDxzdHJpbmcsIGNkay5JUmVzb3VyY2U+ID0gbmV3IE1hcCgpO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIHJlYWRvbmx5IHNjb3BlOiBjZGsuU3RhY2ssIHB1YmxpYyByZWFkb25seSBibHVlcHJpbnRQcm9wczogRWtzQmx1ZXByaW50UHJvcHMpIHt9XG4gICAgXG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyByZXNvdXJjZSBwcm92aWRlciBhbmQgc3BlY2lmaWVzIHRoZSBuYW1lIHVuZGVyIHdoaWNoIHRoZSBwcm92aWRlZCByZXNvdXJjZSB3aWxsIGJlIHJlZ2lzdGVyZWQsXG4gICAgICogQHBhcmFtIG5hbWUgU3BlY2lmaWVzIHRoZSBuYW1lIGtleSB1bmRlciB3aGljaCB0aGUgcHJvdmlkZWQgcmVzb3VyY2VzIHdpbGwgYmUgcmVnaXN0ZXJlZCBmb3Igc3Vic2VxdWVudCBsb29rLXVwcy5cbiAgICAgKiBAcGFyYW0gcHJvdmlkZXIgSW1wbGVtZW50YXRpb24gb2YgdGhlIHJlc291cmNlIHByb3ZpZGVyIGludGVyZmFjZVxuICAgICAqIEByZXR1cm5zIHRoZSBwcm92aWRlZCByZXNvdXJjZVxuICAgICAqL1xuICAgIHB1YmxpYyBhZGQ8VCBleHRlbmRzIGNkay5JUmVzb3VyY2UgPSBjZGsuSVJlc291cmNlPihuYW1lOiBzdHJpbmcsIHByb3ZpZGVyOiBSZXNvdXJjZVByb3ZpZGVyPFQ+KSA6IFQge1xuICAgICAgICBjb25zdCByZXNvdXJjZSA9IHByb3ZpZGVyLnByb3ZpZGUodGhpcyk7XG4gICAgICAgIGFzc2VydCghdGhpcy5yZXNvdXJjZXMuaGFzKG5hbWUpLCBgT3ZlcndyaXRpbmcgJHtuYW1lfSByZXNvdXJjZSBkdXJpbmcgZXhlY3V0aW9uIGlzIG5vdCBhbGxvd2VkLmApO1xuICAgICAgICB0aGlzLnJlc291cmNlcy5zZXQobmFtZSwgcmVzb3VyY2UpO1xuICAgICAgICByZXR1cm4gcmVzb3VyY2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgcHJvdmlkZWQgcmVzb3VyY2UgYnkgdGhlIHN1cHBsaWVkIG5hbWUuIFxuICAgICAqIEBwYXJhbSBuYW1lIHVuZGVyIHdoaWNoIHRoZSByZXNvdXJjZSBwcm92aWRlciB3YXMgcmVnaXN0ZXJlZFxuICAgICAqIEByZXR1cm5zIHRoZSByZXNvdXJjZSBvciB1bmRlZmluZWQgaWYgdGhlIHNwZWNpZmllZCByZXNvdXJjZSB3YXMgbm90IGZvdW5kXG4gICAgICovXG4gICAgcHVibGljIGdldDxUIGV4dGVuZHMgY2RrLklSZXNvdXJjZSA9IGNkay5JUmVzb3VyY2U+KG5hbWU6IHN0cmluZykgOiBUIHwgdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIDxUPnRoaXMucmVzb3VyY2VzLmdldChuYW1lKTtcbiAgICB9XG59XG5cbmV4cG9ydCBlbnVtIEdsb2JhbFJlc291cmNlcyB7XG4gICAgVnBjID0gJ3ZwYycsXG4gICAgSG9zdGVkWm9uZSA9ICdob3N0ZWQtem9uZScsXG4gICAgQ2VydGlmaWNhdGUgPSAnY2VydGlmaWNhdGUnXG59XG5cblxuLyoqXG4gKiBDbHVzdGVyIGluZm8gc3VwcGxpZXMgcmVxdWlyZWQgaW5mb3JtYXRpb24gb24gdGhlIGNsdXN0ZXIgY29uZmlndXJhdGlvbiwgcmVnaXN0ZXJlZCByZXNvdXJjZXMgYW5kIGFkZC1vbnMgXG4gKiB3aGljaCBjb3VsZCBiZSBsZXZlcmFnZWQgYnkgdGhlIGZyYW1ld29yaywgYWRkLW9uIGltcGxlbWVudGF0aW9ucyBhbmQgdGVhbXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBDbHVzdGVySW5mbyB7XG4gICAgXG4gICAgcHJpdmF0ZSByZWFkb25seSBwcm92aXNpb25lZEFkZE9uczogTWFwPHN0cmluZywgQ29uc3RydWN0PjtcbiAgICBwcml2YXRlIHJlYWRvbmx5IHNjaGVkdWxlZEFkZE9uczogTWFwPHN0cmluZywgUHJvbWlzZTxDb25zdHJ1Y3Q+PjtcbiAgICBwcml2YXRlIHJlc291cmNlQ29udGV4dDogUmVzb3VyY2VDb250ZXh0O1xuXG4gICAgLyoqXG4gICAgICogQ29uc3RydWN0b3IgZm9yIENsdXN0ZXJJbmZvXG4gICAgICogQHBhcmFtIHByb3BzIFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHJlYWRvbmx5IGNsdXN0ZXI6IENsdXN0ZXIsIHJlYWRvbmx5IHZlcnNpb246IEt1YmVybmV0ZXNWZXJzaW9uLCBcbiAgICAgICAgICAgIHJlYWRvbmx5IG5vZGVHcm91cHM/OiBOb2RlZ3JvdXBbXSwgcmVhZG9ubHkgYXV0b3NjYWxpbmdHcm91cHM/OiBBdXRvU2NhbGluZ0dyb3VwW10pIHsgXG4gICAgICAgIHRoaXMuY2x1c3RlciA9IGNsdXN0ZXI7XG4gICAgICAgIHRoaXMucHJvdmlzaW9uZWRBZGRPbnMgPSBuZXcgTWFwPHN0cmluZywgQ29uc3RydWN0PigpO1xuICAgICAgICB0aGlzLnNjaGVkdWxlZEFkZE9ucyA9IG5ldyBNYXA8c3RyaW5nLCBQcm9taXNlPENvbnN0cnVjdD4+KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJvdmlkZXMgdGhlIHJlc291cmNlIGNvbnRleHQgb2JqZWN0IGFzc29jaWF0ZWQgd2l0aCB0aGlzIGluc3RhbmNlIG9mIHRoZSBFS1MgQmx1ZXByaW50LlxuICAgICAqIEByZXR1cm5zIHJlc291cmNlIGNvbnRleHQgb2JqZWN0XG4gICAgICovXG4gICAgcHVibGljIGdldFJlc291cmNlQ29udGV4dCgpOiBSZXNvdXJjZUNvbnRleHQge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXNvdXJjZUNvbnRleHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5qZWN0aW9uIG1ldGhvZCB0byBwcm92aWRlIHJlc291cmNlIGNvbnRleHQuXG4gICAgICogQHBhcmFtIHJlc291cmNlQ29udGV4dCBcbiAgICAgKi9cbiAgICBwdWJsaWMgc2V0UmVzb3VyY2VDb250ZXh0KHJlc291cmNlQ29udGV4dDogUmVzb3VyY2VDb250ZXh0KSB7XG4gICAgICAgIHRoaXMucmVzb3VyY2VDb250ZXh0ID0gcmVzb3VyY2VDb250ZXh0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBwcm92aXNpb25lZEFkZE9ucyBtYXBcbiAgICAgKiBAcGFyYW0gYWRkT24gXG4gICAgICogQHBhcmFtIGNvbnN0cnVjdCBcbiAgICAgKi9cbiAgICBwdWJsaWMgYWRkUHJvdmlzaW9uZWRBZGRPbihhZGRPbjogc3RyaW5nLCBjb25zdHJ1Y3Q6IENvbnN0cnVjdCkge1xuICAgICAgICB0aGlzLnByb3Zpc2lvbmVkQWRkT25zLnNldChhZGRPbiwgY29uc3RydWN0KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHaXZlbiB0aGUgYWRkT24gbmFtZSwgcmV0dXJuIHRoZSBwcm92aXNpb25lZCBhZGRPbiBjb25zdHJ1Y3RcbiAgICAgKiBAcGFyYW0gYWRkT24gXG4gICAgICogQHJldHVybnMgdW5kZWZpbmVkXG4gICAgICovXG4gICAgcHVibGljIGdldFByb3Zpc2lvbmVkQWRkT24oYWRkT246IHN0cmluZyk6IENvbnN0cnVjdCB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3Zpc2lvbmVkQWRkT25zLmdldChhZGRPbik7XG4gICAgfVxuXG4gICAgIC8qKlxuICAgICAqIFJldHVybnMgYWxsIHByb3Zpc2lvbmVkIGFkZG9uc1xuICAgICAqIEByZXR1cm5zIHNjaGVkdWxlZEFkZE9uczogTWFwPHN0cmluZywgY2RrLkNvbnN0cnVjdD5cbiAgICAgKi9cbiAgICAgIHB1YmxpYyBnZXRBbGxQcm92aXNpb25lZEFkZG9ucygpOiBNYXA8c3RyaW5nLCBDb25zdHJ1Y3Q+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvdmlzaW9uZWRBZGRPbnM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2V0IHRoZSBwcmVQcm92aXNpb25lZEFkZE9uIG1hcCB3aXRoIHRoZSBwcm9taXNlIGZvciB0aGUgY29uc3RydWN0XG4gICAgICogb2YgdGhlIGFkZG9uIGJlaW5nIHByb3Zpc2lvbmVkXG4gICAgICogQHBhcmFtIGFkZE9uXG4gICAgICogQHBhcmFtIHByb21pc2VcbiAgICAgKi9cbiAgICAgcHVibGljIGFkZFNjaGVkdWxlZEFkZE9uKGFkZE9uOiBzdHJpbmcsIHByb21pc2U6IFByb21pc2U8Q29uc3RydWN0Pikge1xuICAgICAgICB0aGlzLnNjaGVkdWxlZEFkZE9ucy5zZXQoYWRkT24sIHByb21pc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHByb21pc2UgZm9yIHRoZSBBZGRvbiBjb25zdHJ1Y3RcbiAgICAgKiBAcGFyYW0gYWRkT25cbiAgICAgKiBAcmV0dXJucyBQcm9taXNlPGNkay5Db25zdHJ1Y3Q+XG4gICAgICovXG4gICAgcHVibGljIGdldFNjaGVkdWxlZEFkZE9uKGFkZE9uOiBzdHJpbmcpOiBQcm9taXNlPENvbnN0cnVjdD4gfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5zY2hlZHVsZWRBZGRPbnMuZ2V0KGFkZE9uKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFsbCBzY2hlZHVsZWQgYWRkb25zXG4gICAgICogQHJldHVybnMgc2NoZWR1bGVkQWRkT25zOiBNYXA8c3RyaW5nLCBQcm9taXNlPGNkay5Db25zdHJ1Y3Q+PlxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRBbGxTY2hlZHVsZWRBZGRvbnMoKTogTWFwPHN0cmluZywgUHJvbWlzZTxDb25zdHJ1Y3Q+PiB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlZEFkZE9ucztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm92aWRlcyB0aGUgcmVzb3VyY2UgcmVnaXN0ZXJlZCB1bmRlciBzdXBwbGllZCBuYW1lXG4gICAgICogQHBhcmFtIG5hbWUgb2YgdGhlIHJlc291cmNlIHRvIGJlIHJldHVybmVkXG4gICAgICogQHJldHVybnMgUmVzb3VyY2Ugb2JqZWN0IG9yIHVuZGVmaW5lZCBpZiBubyByZXNvdXJjZSB3YXMgZm91bmRcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UmVzb3VyY2U8VCBleHRlbmRzIGNkay5JUmVzb3VyY2U+KG5hbWU6IHN0cmluZyk6IFQgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXNvdXJjZUNvbnRleHQuZ2V0PFQ+KG5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNhbWUgYXMge0BsaW5rIGdldFJlc291cmNlfSBidXQgd2lsbCBmYWlsIGlmIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UgaXMgbm90IGZvdW5kXG4gICAgICogQHBhcmFtIG5hbWUgb2YgdGhlIHJlc291cmNlIHRvIGJlIHJldHVybmVkXG4gICAgICogQHJldHVybnMgUmVzb3VyY2Ugb2JqZWN0IChmYWlscyBpZiBub3QgZm91bmQpXG4gICAgICovXG4gICAgcHVibGljIGdldFJlcXVpcmVkUmVzb3VyY2U8VCBleHRlbmRzIGNkay5JUmVzb3VyY2U+KG5hbWU6IHN0cmluZyk6IFQge1xuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLnJlc291cmNlQ29udGV4dC5nZXQ8VD4obmFtZSk7XG4gICAgICAgIGFzc2VydChyZXN1bHQsICdSZXF1aXJlZCByZXNvdXJjZSAnICsgbmFtZSArICcgaXMgbWlzc2luZy4nKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdCE7XG4gICAgfVxufSJdfQ==